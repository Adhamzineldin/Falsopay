<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="CLASS" height="570px" preserveAspectRatio="none" style="width:771px;height:570px;background:#FFFFFF;" version="1.1" viewBox="0 0 771 570" width="771px" zoomAndPan="magnify"><title>Collaboration Diagram: Security &amp; System Controls</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="343.0684" x="207.1144" y="24.5332">Collaboration Diagram: Security &amp; System Controls</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="239.6406" x="258.8283" y="42.1426">(UC19, UC23, UC28-30, UC32, UC34)</text><g class="entity" data-entity="User" data-source-line="5" data-uid="ent0002" id="entity_User"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.5586" x="227.7" y="63.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.5586" x="234.7" y="79.752">User</text><line style="stroke:#181818;stroke-width:0.5;" x1="228.7" x2="270.2586" y1="84.8281" y2="84.8281"/></g><g class="entity" data-entity="App" data-source-line="6" data-uid="ent0003" id="entity_App"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="38.9102" x="230.2" y="179.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24.9102" x="237.2" y="195.752">App</text><line style="stroke:#181818;stroke-width:0.5;" x1="231.2" x2="268.1102" y1="200.8281" y2="200.8281"/></g><g class="entity" data-entity="Gateway" data-source-line="7" data-uid="ent0004" id="entity_Gateway"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.248" x="215.2" y="295.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.248" x="222.2" y="311.752">Gateway</text><line style="stroke:#181818;stroke-width:0.5;" x1="216.2" x2="283.448" y1="316.8281" y2="316.8281"/></g><g class="entity" data-entity="SecService" data-source-line="8" data-uid="ent0005" id="entity_SecService"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115.1445" x="262.2" y="411.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.1445" x="269.2" y="427.752">Security Service</text><line style="stroke:#181818;stroke-width:0.5;" x1="263.2" x2="376.3445" y1="432.8281" y2="432.8281"/></g><g class="entity" data-entity="FraudService" data-source-line="9" data-uid="ent0006" id="entity_FraudService"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.6064" x="513.7" y="295.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.6064" x="520.7" y="311.752">Fraud Detection</text><line style="stroke:#181818;stroke-width:0.5;" x1="514.7" x2="626.3064" y1="316.8281" y2="316.8281"/></g><g class="entity" data-entity="Database" data-source-line="10" data-uid="ent0007" id="entity_Database"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.9307" x="353.7" y="527.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.9307" x="360.7" y="543.752">Database</text><line style="stroke:#181818;stroke-width:0.5;" x1="354.7" x2="426.6307" y1="548.8281" y2="548.8281"/></g><!--link User to App--><g class="link" data-entity-1="User" data-entity-2="App" data-source-line="13" data-uid="lnk8" id="link_User_App"><path codeLine="13" d="M227.37,94.0088 C206.08,105.9287 178.76,126.4688 189.7,149.2188 C198.02,166.5288 210.7533,176.5771 224.8633,184.6571" fill="none" id="User-to-App" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="230.07,187.6388,224.2476,179.6952,225.7311,185.1541,220.2722,186.6375,230.07,187.6388" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72.9854" x="190.7" y="145.7139">1. Block App</text></g><!--link User to App--><g class="link" data-entity-1="User" data-entity-2="App" data-source-line="27" data-uid="lnk18" id="link_User_App"><path codeLine="27" d="M258.31,101.4688 C261.99,110.2487 265.85,121.0587 267.7,131.2188 C270.68,147.6988 267.3328,160.5553 261.5528,173.7153" fill="none" id="User-to-App-1" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="259.14,179.2088,266.4215,172.577,261.1507,174.6308,259.0969,169.36,259.14,179.2088" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.7554" x="269.7" y="145.7139">11. Set Limits</text></g><!--link App to Gateway--><g class="link" data-entity-1="App" data-entity-2="Gateway" data-source-line="14" data-uid="lnk9" id="link_App_Gateway"><path codeLine="14" d="M229.89,201.0587 C184.73,205.7088 76.36,219.5688 54.7,247.2188 C11.6,302.2188 142.0513,311.5823 208.9513,312.9923" fill="none" id="App-to-Gateway" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="214.95,313.1188,206.0363,308.93,209.9511,313.0134,205.8677,316.9282,214.95,313.1188" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.4199" x="55.7" y="261.7139">2. POST /block</text></g><!--link Gateway to App--><g class="link" data-entity-1="Gateway" data-entity-2="App" data-source-line="18" data-uid="lnk13" id="link_Gateway_App"><path codeLine="18" d="M262.43,295.0788 C270.07,282.0088 277.62,263.8288 273.7,247.2188 C271.26,236.8788 269.1557,231.4671 264.3357,222.8371" fill="none" id="Gateway-to-App" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="261.41,217.5988,262.3063,227.4067,263.8481,221.964,269.2908,223.5058,261.41,217.5988" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.0718" x="276.7" y="261.7139">6. confirm</text></g><!--link App to Gateway--><g class="link" data-entity-1="App" data-entity-2="Gateway" data-source-line="28" data-uid="lnk19" id="link_App_Gateway"><path codeLine="28" d="M229.92,206.5888 C213.16,214.0188 190.2,227.2688 179.7,247.2188 C168.49,268.4988 186.7205,283.9433 209.4705,295.8133" fill="none" id="App-to-Gateway-1" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="214.79,298.5888,208.6611,290.8792,210.3571,296.2759,204.9605,297.9718,214.79,298.5888" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.5127" x="180.7" y="261.7139">12. PUT /limits</text></g><!--link Gateway to App--><g class="link" data-entity-1="Gateway" data-entity-2="App" data-source-line="32" data-uid="lnk23" id="link_Gateway_App"><path codeLine="32" d="M284.3,305.0688 C305.14,298.1888 330.03,286.0088 342.7,265.2188 C362.22,233.1787 307.681,213.9411 275.011,205.3111" fill="none" id="Gateway-to-App-1" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="269.21,203.7788,276.8899,209.9447,274.0442,205.0557,278.9331,202.21,269.21,203.7788" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.7554" x="347.7" y="261.7139">16. refresh UI</text></g><!--link Gateway to SecService--><g class="link" data-entity-1="Gateway" data-entity-2="SecService" data-source-line="15" data-uid="lnk10" id="link_Gateway_SecService"><path codeLine="15" d="M215.18,315.4088 C147.11,316.9488 6,326.6188 51.7,381.2188 C77.97,412.6188 185.4385,423.1797 256.0385,426.9397" fill="none" id="Gateway-to-SecService" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="262.03,427.2587,253.2555,422.7858,257.0371,426.9928,252.83,430.7744,262.03,427.2587" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.9072" x="52.7" y="377.7139">3. blockUser()</text></g><!--link SecService to Gateway--><g class="link" data-entity-1="SecService" data-entity-2="Gateway" data-source-line="17" data-uid="lnk12" id="link_SecService_Gateway"><path codeLine="17" d="M310.47,410.9688 C303.51,397.5288 293.51,378.9388 283.7,363.2188 C277.43,353.1688 273.3926,347.2185 266.9826,338.4185" fill="none" id="SecService-to-Gateway" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="263.45,333.5688,265.5158,343.1985,266.3939,337.6102,271.9821,338.4884,263.45,333.5688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.5381" x="295.7" y="377.7139">5. 200 OK</text></g><!--link Gateway to SecService--><g class="link" data-entity-1="Gateway" data-entity-2="SecService" data-source-line="29" data-uid="lnk20" id="link_Gateway_SecService"><path codeLine="29" d="M215.03,327.1788 C186.47,338.9888 153.14,358.5288 169.7,381.2188 C190.73,410.0388 223.3621,421.0878 256.1221,425.8378" fill="none" id="Gateway-to-SecService-1" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="262.06,426.6988,253.7271,421.4487,257.1117,425.9813,252.5792,429.3659,262.06,426.6988" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.0508" x="170.7" y="377.7139">13. updateLimits()</text></g><!--link SecService to Gateway--><g class="link" data-entity-1="SecService" data-entity-2="Gateway" data-source-line="31" data-uid="lnk22" id="link_SecService_Gateway"><path codeLine="31" d="M344.37,410.9688 C359.21,397.6888 373.34,379.2988 362.7,363.2188 C345.41,337.0888 316.5865,326.3497 290.1865,320.9097" fill="none" id="SecService-to-Gateway-1" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="284.31,319.6988,292.3175,325.4328,289.2071,320.7079,293.9321,317.5974,284.31,319.6988" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.7681" x="367.7" y="377.7139">15. 200 OK</text></g><!--link SecService to Database--><g class="link" data-entity-1="SecService" data-entity-2="Database" data-source-line="16" data-uid="lnk11" id="link_SecService_Database"><path codeLine="16" d="M261.8,436.7888 C207.79,444.2988 139.59,461.1488 168.7,497.2188 C191.48,525.4488 290.2207,537.4003 347.3207,542.1603" fill="none" id="SecService-to-Database" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="353.3,542.6588,344.6634,537.9249,348.3173,542.2434,343.9988,545.8973,353.3,542.6588" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97.5317" x="169.7" y="493.7139">4. setBlockFlag()</text></g><!--link SecService to Database--><g class="link" data-entity-1="SecService" data-entity-2="Database" data-source-line="24" data-uid="lnk17" id="link_SecService_Database"><path codeLine="24" d="M310.13,449.4288 C304.23,463.3588 299.26,482.5888 307.7,497.2188 C317.6,514.3788 330.7317,523.5569 347.8317,531.0269" fill="none" id="SecService-to-Database-1" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="353.33,533.4288,346.6838,526.1604,348.7481,531.4272,343.4813,533.4914,353.33,533.4288" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.2217" x="308.7" y="493.7139">10. flagTransaction()</text></g><!--link SecService to Database--><g class="link" data-entity-1="SecService" data-entity-2="Database" data-source-line="30" data-uid="lnk21" id="link_SecService_Database"><path codeLine="30" d="M377.48,441.8388 C398.51,448.7988 420.17,460.2888 432.7,479.2188 C443.34,495.2988 433.6879,509.8108 419.0379,523.1408" fill="none" id="SecService-to-Database-2" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="414.6,527.1788,423.9488,524.0803,418.2982,523.8138,418.5648,518.1632,414.6,527.1788" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.6963" x="436.7" y="493.7139">14. storeNewLimit()</text></g><!--link FraudService to FraudService--><g class="link" data-entity-1="FraudService" data-entity-2="FraudService" data-source-line="21" data-uid="lnk14" id="link_FraudService_FraudService"><path codeLine="21" d="M627.75,303.3488 C647.12,303.2888 662.7,306.9088 662.7,314.2188 C662.7,321.5288 653.12,325.1673 633.75,325.1073" fill="none" id="FraudService-to-FraudService" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="627.75,325.0888,636.7376,329.1166,632.75,325.1042,636.7623,321.1166,627.75,325.0888" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89.5972" x="668.7" y="319.7139">7. Detect Fraud</text></g><!--link FraudService to Database--><g class="link" data-entity-1="FraudService" data-entity-2="Database" data-source-line="22" data-uid="lnk15" id="link_FraudService_Database"><path codeLine="22" d="M575.52,333.3988 C583.84,369.1588 596.49,449.3488 557.7,497.2188 C526.55,535.6488 472.766,544.3186 433.826,545.7486" fill="none" id="FraudService-to-Database" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="427.83,545.9688,436.9707,549.6358,432.8266,545.7853,436.6771,541.6412,427.83,545.9688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.3335" x="584.7" y="435.7139">8. analyzePatterns()</text></g><!--link FraudService to SecService--><g class="link" data-entity-1="FraudService" data-entity-2="SecService" data-source-line="23" data-uid="lnk16" id="link_FraudService_SecService"><path codeLine="23" d="M537.72,333.2188 C511.92,347.0388 474.95,366.2188 441.7,381.2188 C418.05,391.8887 396.8751,400.4381 374.4351,409.0081" fill="none" id="FraudService-to-SecService" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="368.83,411.1488,378.6648,411.6745,373.501,409.3649,375.8106,404.201,368.83,411.1488" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48.4009" x="477.7" y="377.7139">9. alert()</text></g><!--SRC=[VLB1Rjf04BtxAqOSKf3A1cFQ0eT8BIXLrQg9vFZMos06iktYjNQ7HlJhExl6YGajb_NEpDkPz-QPDHk2ti8QWolhaBMjOAbnwt0tXvpAlTDyW2l83vvf1mjRiRF6_wZwnIATlOLYCSxYEHrcet39nl6S37f9yWQMjD4LWMzUr-XObxh6YZsW1xlwIINxfFb2uScrzuzrtLu_8zCJ7jgmzymg9_TRbzGBhIHv39znjmxtQs704eci28kvLy0bCgxGK-0hGcOmX4_6bhyYXy09XiER4C0SKjMfXLGe7GbAUQpW_Yv_WEjL02Lj8O1U20ekKn0HeNj_a7Hg0TeI4k14WIUE8syDRi-nBxFVAHYFHd3tzMHiG_kzWj9M6-rsHv5J4Tbifba9z8yMiTFRBJbQ3vBkhcAlayGSFgYJ5kVuZewf0gpG7FxGFJAJgtp_7mDETZIJ9uOSNznFEbAmaSKyEAmyHfy57pLc4z6O4yCtlTFoaxrsKgpiLC-zJ8EPXNXf6iH_pKp5pNszbdBJwpBXu2XRHz_fAS8lMPfUyZGLKnrj7Fb7ABuaVm40]--></g></svg>