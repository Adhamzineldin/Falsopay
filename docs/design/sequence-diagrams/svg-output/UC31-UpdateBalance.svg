<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1910px" preserveAspectRatio="none" style="width:1376px;height:1910px;background:#FFFFFF;" version="1.1" viewBox="0 0 1376 1910" width="1376px" zoomAndPan="magnify"><title>UC-31: Update Balance</title><defs/><g><rect fill="#FFFFCC" height="28.0566" rx="2.5" ry="2.5" style="stroke:#FFDD88;stroke-width:3;" width="1365.1299" x="5" y="5"/><text fill="#000000" font-family="monospace" font-size="10" lengthAdjust="spacing" textLength="354.0576" x="10" y="20">Please&#160;use&#160;'!option&#160;handwritten&#160;true'&#160;to&#160;enable&#160;handwritten</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="154.041" x="599.5444" y="67.5898">UC-31: Update Balance</text><rect fill="none" height="181.5938" style="stroke:#000000;stroke-width:1.5;" width="420.0195" x="848.1797" y="512.791"/><rect fill="none" height="467.7578" style="stroke:#000000;stroke-width:1.5;" width="928.8755" x="415.2544" y="1344.0645"/><g><title>Transaction</title><rect fill="#000000" fill-opacity="0.00000" height="1669.5469" width="8" x="197.5723" y="159.2754"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="201" x2="201" y1="159.2754" y2="1828.8223"/></g><g><title>Account</title><rect fill="#000000" fill-opacity="0.00000" height="1669.5469" width="8" x="453.5474" y="159.2754"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="457.2544" x2="457.2544" y1="159.2754" y2="1828.8223"/></g><g><title>Notification</title><rect fill="#000000" fill-opacity="0.00000" height="1669.5469" width="8" x="689.3853" y="159.2754"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="692.7578" x2="692.7578" y1="159.2754" y2="1828.8223"/></g><g><title>API Gateway</title><rect fill="#000000" fill-opacity="0.00000" height="1669.5469" width="8" x="902.0313" y="159.2754"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="905.1797" x2="905.1797" y1="159.2754" y2="1828.8223"/></g><g><title>FalsoPay App</title><rect fill="#000000" fill-opacity="0.00000" height="1669.5469" width="8" x="1060.5483" y="159.2754"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1063.9692" x2="1063.9692" y1="159.2754" y2="1828.8223"/></g><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="1669.5469" width="8" x="1236.4199" y="159.2754"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1239.6406" x2="1239.6406" y1="159.2754" y2="1828.8223"/></g><g><title>Database</title><rect fill="#000000" fill-opacity="0.00000" height="1669.5469" width="8" x="1297.1646" y="159.2754"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1300.1992" x2="1300.1992" y1="159.2754" y2="1828.8223"/></g><g class="participant participant-head" data-participant="txnService"><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87.1445" x="158" y="109.0566"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.1445" x="165" y="130.5898">Transaction</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.6826" x="178.231" y="148.1992">Service</text></g><g class="participant participant-tail" data-participant="txnService"><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87.1445" x="158" y="1827.8223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.1445" x="165" y="1849.3555">Transaction</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.6826" x="178.231" y="1866.9648">Service</text></g><g class="participant participant-head" data-participant="accountService"><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.5859" x="425.2544" y="109.0566"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5859" x="432.2544" y="130.5898">Account</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.6826" x="434.2061" y="148.1992">Service</text></g><g class="participant participant-tail" data-participant="accountService"><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.5859" x="425.2544" y="1827.8223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5859" x="432.2544" y="1849.3555">Account</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.6826" x="434.2061" y="1866.9648">Service</text></g><g class="participant participant-head" data-participant="notifService"><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="83.2549" x="651.7578" y="109.0566"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69.2549" x="658.7578" y="130.5898">Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.6826" x="670.0439" y="148.1992">Service</text></g><g class="participant participant-tail" data-participant="notifService"><rect fill="#E2E2F0" height="49.2188" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="83.2549" x="651.7578" y="1827.8223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69.2549" x="658.7578" y="1849.3555">Notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.6826" x="670.0439" y="1866.9648">Service</text></g><g class="participant participant-head" data-participant="gateway"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95.7031" x="858.1797" y="126.666"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.7031" x="865.1797" y="148.1992">API Gateway</text></g><g class="participant participant-tail" data-participant="gateway"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95.7031" x="858.1797" y="1827.8223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.7031" x="865.1797" y="1849.3555">API Gateway</text></g><g class="participant participant-head" data-participant="app"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.1582" x="1013.9692" y="126.666"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.1582" x="1020.9692" y="148.1992">FalsoPay App</text></g><g class="participant participant-tail" data-participant="app"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.1582" x="1013.9692" y="1827.8223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.1582" x="1020.9692" y="1849.3555">FalsoPay App</text></g><g class="participant participant-head" data-participant="user"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.5586" x="1222.6406" y="156.1992">User</text><ellipse cx="1240.4199" cy="90.166" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M1240.4199,98.166 L1240.4199,125.166 M1227.4199,106.166 L1253.4199,106.166 M1240.4199,125.166 L1227.4199,140.166 M1240.4199,125.166 L1253.4199,140.166" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="user"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.5586" x="1222.6406" y="1842.3555">User</text><ellipse cx="1240.4199" cy="1853.9316" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M1240.4199,1861.9316 L1240.4199,1888.9316 M1227.4199,1869.9316 L1253.4199,1869.9316 M1240.4199,1888.9316 L1227.4199,1903.9316 M1240.4199,1888.9316 L1253.4199,1903.9316" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="db"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.9307" x="1268.1992" y="156.1992">Database</text><path d="M1283.1646,105.666 C1283.1646,95.666 1301.1646,95.666 1301.1646,95.666 C1301.1646,95.666 1319.1646,95.666 1319.1646,105.666 L1319.1646,131.666 C1319.1646,141.666 1301.1646,141.666 1301.1646,141.666 C1301.1646,141.666 1283.1646,141.666 1283.1646,131.666 L1283.1646,105.666" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1283.1646,105.666 C1283.1646,115.666 1301.1646,115.666 1301.1646,115.666 C1301.1646,115.666 1319.1646,115.666 1319.1646,105.666" fill="none" style="stroke:#181818;stroke-width:1.5;"/></g><g class="participant participant-tail" data-participant="db"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.9307" x="1268.1992" y="1842.3555">Database</text><path d="M1283.1646,1855.4316 C1283.1646,1845.4316 1301.1646,1845.4316 1301.1646,1845.4316 C1301.1646,1845.4316 1319.1646,1845.4316 1319.1646,1855.4316 L1319.1646,1881.4316 C1319.1646,1891.4316 1301.1646,1891.4316 1301.1646,1891.4316 C1301.1646,1891.4316 1283.1646,1891.4316 1283.1646,1881.4316 L1283.1646,1855.4316" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1283.1646,1855.4316 C1283.1646,1865.4316 1301.1646,1865.4316 1301.1646,1865.4316 C1301.1646,1865.4316 1319.1646,1865.4316 1319.1646,1855.4316" fill="none" style="stroke:#181818;stroke-width:1.5;"/></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1354.1299" x="0" y="190.4512"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1354.1299" y1="190.4512" y2="190.4512"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1354.1299" y1="193.4512" y2="193.4512"/><rect fill="#EEEEEE" height="24.3516" style="stroke:#000000;stroke-width:2;" width="162.1226" x="596.0037" y="179.2754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144.5107" x="602.0037" y="196.7705">Main Success Scenario</text><path d="M74,218.627 L74,244.627 L328,244.627 L328,228.627 L318,218.627 L74,218.627" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M318,218.627 L318,228.627 L328,228.627 L318,218.627" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233.416" x="80" y="237.1221">Transaction affecting balance completed</text><g class="message" data-participant-1="txnService" data-participant-2="accountService"><polygon fill="#181818" points="445.5474,268.3301,455.5474,272.3301,445.5474,276.3301,449.5474,272.3301" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="201.5723" x2="451.5474" y1="272.3301" y2="272.3301"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.9434" x="259.0881" y="267.4736">Request balance update</text></g><g class="message" data-participant-1="accountService" data-participant-2="db"><polygon fill="#181818" points="1289.1646,298.6816,1299.1646,302.6816,1289.1646,306.6816,1293.1646,302.6816" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="457.5474" x2="1295.1646" y1="302.6816" y2="302.6816"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.6289" x="808.5415" y="297.8252">Retrieve current balance</text></g><g class="message" data-participant-1="db" data-participant-2="accountService"><polygon fill="#181818" points="468.5474,329.0332,458.5474,333.0332,468.5474,337.0332,464.5474,333.0332" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="462.5474" x2="1300.1646" y1="333.0332" y2="333.0332"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.498" x="833.1069" y="328.1768">Current balance</text></g><g class="message" data-participant-1="accountService" data-participant-2="accountService"><line style="stroke:#181818;stroke-width:1;" x1="457.5474" x2="499.5474" y1="363.3848" y2="363.3848"/><line style="stroke:#181818;stroke-width:1;" x1="499.5474" x2="499.5474" y1="363.3848" y2="376.3848"/><line style="stroke:#181818;stroke-width:1;" x1="458.5474" x2="499.5474" y1="376.3848" y2="376.3848"/><polygon fill="#181818" points="468.5474,372.3848,458.5474,376.3848,468.5474,380.3848,464.5474,376.3848" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.8062" x="464.5474" y="358.5283">Calculate new balance</text></g><g class="message" data-participant-1="accountService" data-participant-2="db"><polygon fill="#181818" points="1289.1646,402.7363,1299.1646,406.7363,1289.1646,410.7363,1293.1646,406.7363" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="457.5474" x2="1295.1646" y1="406.7363" y2="406.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.9033" x="798.4043" y="401.8799">Update balance in database</text></g><g class="message" data-participant-1="db" data-participant-2="accountService"><polygon fill="#181818" points="468.5474,433.0879,458.5474,437.0879,468.5474,441.0879,464.5474,437.0879" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="462.5474" x2="1300.1646" y1="437.0879" y2="437.0879"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97.5825" x="830.5647" y="432.2314">Balance updated</text></g><g class="message" data-participant-1="accountService" data-participant-2="notifService"><polygon fill="#181818" points="681.3853,463.4395,691.3853,467.4395,681.3853,471.4395,685.3853,467.4395" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="457.5474" x2="687.3853" y1="467.4395" y2="467.4395"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.3315" x="493.8005" y="462.583">Request balance notification</text></g><g class="message" data-participant-1="notifService" data-participant-2="gateway"><polygon fill="#181818" points="894.0313,493.791,904.0313,497.791,894.0313,501.791,898.0313,497.791" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="693.3853" x2="900.0313" y1="497.791" y2="497.791"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.646" x="705.3853" y="492.9346">Send balance update notification</text></g><path d="M848.1797,512.791 L908.3506,512.791 L908.3506,521.1426 L898.3506,531.1426 L848.1797,531.1426 L848.1797,512.791" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="181.5938" style="stroke:#000000;stroke-width:1.5;" width="420.0195" x="848.1797" y="512.791"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15.1709" x="863.1797" y="527.2861">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="105.1284" x="923.3506" y="526.21">[User Active in App]</text><g class="message" data-participant-1="gateway" data-participant-2="app"><polygon fill="#181818" points="1052.5483,549.4941,1062.5483,553.4941,1052.5483,557.4941,1056.5483,553.4941" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="906.0313" x2="1058.5483" y1="553.4941" y2="553.4941"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1543" x="924.2126" y="548.6377">Push balance update</text></g><g class="message" data-participant-1="app" data-participant-2="app"><line style="stroke:#181818;stroke-width:1;" x1="1064.5483" x2="1106.5483" y1="583.8457" y2="583.8457"/><line style="stroke:#181818;stroke-width:1;" x1="1106.5483" x2="1106.5483" y1="583.8457" y2="596.8457"/><line style="stroke:#181818;stroke-width:1;" x1="1065.5483" x2="1106.5483" y1="596.8457" y2="596.8457"/><polygon fill="#181818" points="1075.5483,592.8457,1065.5483,596.8457,1075.5483,600.8457,1071.5483,596.8457" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.8716" x="1071.5483" y="578.9893">Update UI with new balance</text></g><g class="message" data-participant-1="app" data-participant-2="user"><polygon fill="#181818" points="1228.4199,623.1973,1238.4199,627.1973,1228.4199,631.1973,1232.4199,627.1973" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1064.5483" x2="1234.4199" y1="627.1973" y2="627.1973"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.3779" x="1081.2952" y="622.3408">Display updated balance</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="848.1797" x2="1268.1992" y1="636.1973" y2="636.1973"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="89.2407" x="853.1797" y="647.6162">[User Not Active]</text><g class="message" data-participant-1="gateway" data-participant-2="gateway"><line style="stroke:#181818;stroke-width:1;" x1="906.0313" x2="948.0313" y1="673.3848" y2="673.3848"/><line style="stroke:#181818;stroke-width:1;" x1="948.0313" x2="948.0313" y1="673.3848" y2="686.3848"/><line style="stroke:#181818;stroke-width:1;" x1="907.0313" x2="948.0313" y1="686.3848" y2="686.3848"/><polygon fill="#181818" points="917.0313,682.3848,907.0313,686.3848,917.0313,690.3848,913.0313,686.3848" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.5171" x="913.0313" y="668.5283">Store notification for later</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1354.1299" x="0" y="722.5605"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1354.1299" y1="722.5605" y2="722.5605"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1354.1299" y1="725.5605" y2="725.5605"/><rect fill="#EEEEEE" height="24.3516" style="stroke:#000000;stroke-width:2;" width="247.3208" x="553.4045" y="711.3848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="229.709" x="559.4045" y="728.8799">Alternative Scenario: Update Conflict</text><path d="M5,750.7363 L5,776.7363 L399,776.7363 L399,760.7363 L389,750.7363 L5,750.7363" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M389,750.7363 L389,760.7363 L399,760.7363 L389,750.7363" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="373.5913" x="11" y="769.2314">Multiple transactions affecting balance completed simultaneously</text><g class="message" data-participant-1="txnService" data-participant-2="accountService"><polygon fill="#181818" points="445.5474,800.4395,455.5474,804.4395,445.5474,808.4395,449.5474,804.4395" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="201.5723" x2="451.5474" y1="804.4395" y2="804.4395"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.9751" x="213.5723" y="799.583">Request balance update (Transaction 1)</text></g><g class="message" data-participant-1="txnService" data-participant-2="accountService"><polygon fill="#181818" points="445.5474,830.791,455.5474,834.791,445.5474,838.791,449.5474,834.791" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="201.5723" x2="451.5474" y1="834.791" y2="834.791"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.9751" x="213.5723" y="829.9346">Request balance update (Transaction 2)</text></g><g class="message" data-participant-1="accountService" data-participant-2="db"><polygon fill="#181818" points="1289.1646,861.1426,1299.1646,865.1426,1289.1646,869.1426,1293.1646,865.1426" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="457.5474" x2="1295.1646" y1="865.1426" y2="865.1426"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232.6606" x="763.0256" y="860.2861">Retrieve current balance (Transaction 1)</text></g><g class="message" data-participant-1="db" data-participant-2="accountService"><polygon fill="#181818" points="468.5474,891.4941,458.5474,895.4941,468.5474,899.4941,464.5474,895.4941" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="462.5474" x2="1300.1646" y1="895.4941" y2="895.4941"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.5298" x="787.5911" y="890.6377">Current balance (Transaction 1)</text></g><g class="message" data-participant-1="accountService" data-participant-2="accountService"><line style="stroke:#181818;stroke-width:1;" x1="457.5474" x2="499.5474" y1="925.8457" y2="925.8457"/><line style="stroke:#181818;stroke-width:1;" x1="499.5474" x2="499.5474" y1="925.8457" y2="938.8457"/><line style="stroke:#181818;stroke-width:1;" x1="458.5474" x2="499.5474" y1="938.8457" y2="938.8457"/><polygon fill="#181818" points="468.5474,934.8457,458.5474,938.8457,468.5474,942.8457,464.5474,938.8457" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.8379" x="464.5474" y="920.9893">Calculate new balance (Transaction 1)</text></g><g class="message" data-participant-1="accountService" data-participant-2="db"><polygon fill="#181818" points="1289.1646,965.1973,1299.1646,969.1973,1289.1646,973.1973,1293.1646,969.1973" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="457.5474" x2="1295.1646" y1="969.1973" y2="969.1973"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252.9351" x="752.8884" y="964.3408">Update balance in database (Transaction 1)</text></g><g class="message" data-participant-1="db" data-participant-2="accountService"><polygon fill="#181818" points="468.5474,995.5488,458.5474,999.5488,468.5474,1003.5488,464.5474,999.5488" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="462.5474" x2="1300.1646" y1="999.5488" y2="999.5488"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.6143" x="785.0488" y="994.6924">Balance updated (Transaction 1)</text></g><g class="message" data-participant-1="accountService" data-participant-2="db"><polygon fill="#181818" points="1289.1646,1025.9004,1299.1646,1029.9004,1289.1646,1033.9004,1293.1646,1029.9004" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="457.5474" x2="1295.1646" y1="1029.9004" y2="1029.9004"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232.6606" x="763.0256" y="1025.0439">Retrieve current balance (Transaction 2)</text></g><g class="message" data-participant-1="db" data-participant-2="accountService"><polygon fill="#181818" points="468.5474,1056.252,458.5474,1060.252,468.5474,1064.252,464.5474,1060.252" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="462.5474" x2="1300.1646" y1="1060.252" y2="1060.252"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.5952" x="772.0583" y="1055.3955">Current balance (After Transaction 1)</text></g><g class="message" data-participant-1="accountService" data-participant-2="accountService"><line style="stroke:#181818;stroke-width:1;" x1="457.5474" x2="499.5474" y1="1090.6035" y2="1090.6035"/><line style="stroke:#181818;stroke-width:1;" x1="499.5474" x2="499.5474" y1="1090.6035" y2="1103.6035"/><line style="stroke:#181818;stroke-width:1;" x1="458.5474" x2="499.5474" y1="1103.6035" y2="1103.6035"/><polygon fill="#181818" points="468.5474,1099.6035,458.5474,1103.6035,468.5474,1107.6035,464.5474,1103.6035" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.8379" x="464.5474" y="1085.7471">Calculate new balance (Transaction 2)</text></g><g class="message" data-participant-1="accountService" data-participant-2="db"><polygon fill="#181818" points="1289.1646,1129.9551,1299.1646,1133.9551,1289.1646,1137.9551,1293.1646,1133.9551" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="457.5474" x2="1295.1646" y1="1133.9551" y2="1133.9551"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252.9351" x="752.8884" y="1129.0986">Update balance in database (Transaction 2)</text></g><g class="message" data-participant-1="db" data-participant-2="accountService"><polygon fill="#181818" points="468.5474,1160.3066,458.5474,1164.3066,468.5474,1168.3066,464.5474,1164.3066" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="462.5474" x2="1300.1646" y1="1164.3066" y2="1164.3066"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.6143" x="785.0488" y="1159.4502">Balance updated (Transaction 2)</text></g><g class="message" data-participant-1="accountService" data-participant-2="txnService"><polygon fill="#181818" points="212.5723,1190.6582,202.5723,1194.6582,212.5723,1198.6582,208.5723,1194.6582" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="206.5723" x2="456.5474" y1="1194.6582" y2="1194.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.3315" x="228.394" y="1189.8018">Request transaction log verification</text></g><g class="message" data-participant-1="txnService" data-participant-2="db"><polygon fill="#181818" points="1289.1646,1221.0098,1299.1646,1225.0098,1289.1646,1229.0098,1293.1646,1225.0098" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="201.5723" x2="1295.1646" y1="1225.0098" y2="1225.0098"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.0698" x="679.8335" y="1220.1533">Retrieve transaction logs</text></g><g class="message" data-participant-1="db" data-participant-2="txnService"><polygon fill="#181818" points="212.5723,1251.3613,202.5723,1255.3613,212.5723,1259.3613,208.5723,1255.3613" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="206.5723" x2="1300.1646" y1="1255.3613" y2="1255.3613"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.3799" x="703.6785" y="1250.5049">Transaction logs</text></g><g class="message" data-participant-1="txnService" data-participant-2="txnService"><line style="stroke:#181818;stroke-width:1;" x1="201.5723" x2="243.5723" y1="1285.7129" y2="1285.7129"/><line style="stroke:#181818;stroke-width:1;" x1="243.5723" x2="243.5723" y1="1285.7129" y2="1298.7129"/><line style="stroke:#181818;stroke-width:1;" x1="202.5723" x2="243.5723" y1="1298.7129" y2="1298.7129"/><polygon fill="#181818" points="212.5723,1294.7129,202.5723,1298.7129,212.5723,1302.7129,208.5723,1298.7129" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.1016" x="208.5723" y="1280.8564">Verify balance consistency with logs</text></g><g class="message" data-participant-1="txnService" data-participant-2="accountService"><polygon fill="#181818" points="445.5474,1325.0645,455.5474,1329.0645,445.5474,1333.0645,449.5474,1329.0645" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="201.5723" x2="451.5474" y1="1329.0645" y2="1329.0645"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.709" x="279.7053" y="1324.208">Verification result</text></g><path d="M415.2544,1344.0645 L475.4253,1344.0645 L475.4253,1352.416 L465.4253,1362.416 L415.2544,1362.416 L415.2544,1344.0645" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="467.7578" style="stroke:#000000;stroke-width:1.5;" width="928.8755" x="415.2544" y="1344.0645"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="15.1709" x="430.2544" y="1358.5596">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="109.4092" x="490.4253" y="1357.4834">[Balance Consistent]</text><g class="message" data-participant-1="accountService" data-participant-2="notifService"><polygon fill="#181818" points="681.3853,1380.7676,691.3853,1384.7676,681.3853,1388.7676,685.3853,1384.7676" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="457.5474" x2="687.3853" y1="1384.7676" y2="1384.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.3315" x="493.8005" y="1379.9111">Request balance notification</text></g><g class="message" data-participant-1="notifService" data-participant-2="gateway"><polygon fill="#181818" points="894.0313,1411.1191,904.0313,1415.1191,894.0313,1419.1191,898.0313,1415.1191" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="693.3853" x2="900.0313" y1="1415.1191" y2="1415.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.646" x="705.3853" y="1410.2627">Send balance update notification</text></g><g class="message" data-participant-1="gateway" data-participant-2="app"><polygon fill="#181818" points="1052.5483,1441.4707,1062.5483,1445.4707,1052.5483,1449.4707,1056.5483,1445.4707" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="906.0313" x2="1058.5483" y1="1445.4707" y2="1445.4707"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1543" x="924.2126" y="1440.6143">Push balance update</text></g><g class="message" data-participant-1="app" data-participant-2="app"><line style="stroke:#181818;stroke-width:1;" x1="1064.5483" x2="1106.5483" y1="1475.8223" y2="1475.8223"/><line style="stroke:#181818;stroke-width:1;" x1="1106.5483" x2="1106.5483" y1="1475.8223" y2="1488.8223"/><line style="stroke:#181818;stroke-width:1;" x1="1065.5483" x2="1106.5483" y1="1488.8223" y2="1488.8223"/><polygon fill="#181818" points="1075.5483,1484.8223,1065.5483,1488.8223,1075.5483,1492.8223,1071.5483,1488.8223" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.8716" x="1071.5483" y="1470.9658">Update UI with new balance</text></g><g class="message" data-participant-1="app" data-participant-2="user"><polygon fill="#181818" points="1228.4199,1515.1738,1238.4199,1519.1738,1228.4199,1523.1738,1232.4199,1519.1738" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1064.5483" x2="1234.4199" y1="1519.1738" y2="1519.1738"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.3779" x="1081.2952" y="1514.3174">Display updated balance</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="415.2544" x2="1344.1299" y1="1528.1738" y2="1528.1738"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="117.3584" x="420.2544" y="1539.5928">[Balance Inconsistent]</text><g class="message" data-participant-1="accountService" data-participant-2="accountService"><line style="stroke:#181818;stroke-width:1;" x1="457.5474" x2="499.5474" y1="1565.3613" y2="1565.3613"/><line style="stroke:#181818;stroke-width:1;" x1="499.5474" x2="499.5474" y1="1565.3613" y2="1578.3613"/><line style="stroke:#181818;stroke-width:1;" x1="458.5474" x2="499.5474" y1="1578.3613" y2="1578.3613"/><polygon fill="#181818" points="468.5474,1574.3613,458.5474,1578.3613,468.5474,1582.3613,464.5474,1578.3613" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.7598" x="464.5474" y="1560.5049">Calculate correct balance from logs</text></g><g class="message" data-participant-1="accountService" data-participant-2="db"><polygon fill="#181818" points="1289.1646,1604.7129,1299.1646,1608.7129,1289.1646,1612.7129,1293.1646,1608.7129" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="457.5474" x2="1295.1646" y1="1608.7129" y2="1608.7129"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.0698" x="807.821" y="1603.8564">Force balance correction</text></g><g class="message" data-participant-1="db" data-participant-2="accountService"><polygon fill="#181818" points="468.5474,1635.0645,458.5474,1639.0645,468.5474,1643.0645,464.5474,1639.0645" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="462.5474" x2="1300.1646" y1="1639.0645" y2="1639.0645"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.7808" x="826.9656" y="1634.208">Balance corrected</text></g><g class="message" data-participant-1="accountService" data-participant-2="notifService"><polygon fill="#181818" points="681.3853,1665.416,691.3853,1669.416,681.3853,1673.416,685.3853,1669.416" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="457.5474" x2="687.3853" y1="1669.416" y2="1669.416"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.3315" x="493.8005" y="1664.5596">Request balance notification</text></g><g class="message" data-participant-1="notifService" data-participant-2="gateway"><polygon fill="#181818" points="894.0313,1695.7676,904.0313,1699.7676,894.0313,1703.7676,898.0313,1699.7676" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="693.3853" x2="900.0313" y1="1699.7676" y2="1699.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.646" x="705.3853" y="1694.9111">Send balance update notification</text></g><g class="message" data-participant-1="gateway" data-participant-2="app"><polygon fill="#181818" points="1052.5483,1726.1191,1062.5483,1730.1191,1052.5483,1734.1191,1056.5483,1730.1191" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="906.0313" x2="1058.5483" y1="1730.1191" y2="1730.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1543" x="924.2126" y="1725.2627">Push balance update</text></g><g class="message" data-participant-1="app" data-participant-2="app"><line style="stroke:#181818;stroke-width:1;" x1="1064.5483" x2="1106.5483" y1="1760.4707" y2="1760.4707"/><line style="stroke:#181818;stroke-width:1;" x1="1106.5483" x2="1106.5483" y1="1760.4707" y2="1773.4707"/><line style="stroke:#181818;stroke-width:1;" x1="1065.5483" x2="1106.5483" y1="1773.4707" y2="1773.4707"/><polygon fill="#181818" points="1075.5483,1769.4707,1065.5483,1773.4707,1075.5483,1777.4707,1071.5483,1773.4707" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.8716" x="1071.5483" y="1755.6143">Update UI with new balance</text></g><g class="message" data-participant-1="app" data-participant-2="user"><polygon fill="#181818" points="1228.4199,1799.8223,1238.4199,1803.8223,1228.4199,1807.8223,1232.4199,1803.8223" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1064.5483" x2="1234.4199" y1="1803.8223" y2="1803.8223"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.3779" x="1081.2952" y="1798.9658">Display updated balance</text></g><!--SRC=[vLPDSzem4BthL-nmQWuvXDwOeJE4J3evq65AoQcNHPP14o6vaWpbttVbBsJZ98GqqqCvoVRRrTktRoNSazGPMjo24xzoeRcO2UTmBIPAhZLmeRsmp3Me5VAdjJMvJgP66GlxZVGY-hv1dUojz5veI54vmPYNNWaOBAVNdsz6iCmIz09kKI5jDc2CuhpaCaFjOV33edR8lJJwfru8kvE40NJWVzUFxO09vqJ6jy5OlkmD-6QyJ2N7qorq-DA_oVm1lXBhFHuAvBfSjq7tLAsPum4cMLQoo396fP18WwKJjdYNquAH0BX2HvhSLQlYMx9YR3o66KeDYvnpwWCig05efO7nc34YAC3iX8tK644a6M2Q2bhfDVMfq1UusMPAU95G7veWkFxIqMW4tqFxdMy2yw9Fh0qBWSagWBsLOaVfSsl98dKKIrPmtPDyse7rf3q9GSLp5QoYnRu9xATJUQgcJlhL4Zz7wBPLPT97ABR3gJmwiX6BeI6qyiS85a8d7KNRaGoLX-0Ec53VTWLtyWy3-bLP2d6oR0Jpt6swxGau-jXWAYMM3x2NVjEIBe865uxWJhfCKVvAWmOeQ6fBJZGh5QykeME5vEzsJP2IuqFZBAFg2qjF53rfB0gi7TrmdHgTAidz2nQVvSfBiZ7uezVTIsO79xSKWrgOtAd3PTw7J_5etLpzXIJ3A_R6YJeXSTw4dOHTEd4dYTuwWUSMq9d8SmeuNxVX-RfDKl8gV8Xwm_UgDxnClNxNnGDMUpUQBr1c3JI8nxEgRV-M-9quLzDyxfugC9s4CVOnx7k8vbexwUWl1J-KvreH__8uFaRKmGf7nq5vsjPIJUkalZmQttC1X0INNmB__B2l9NdG_3LHdhSzDpH9_2XGQissR5H_fc2WUsEvYDfSPAWbUSNg5Pekx_-vVNJ3_W40]--></g></svg>